import{_ as s,o as n,c as a,a as p}from"./app.9b3d8235.js";const l=JSON.parse('{"title":"从零开始安装部署运行时环境","description":"","frontmatter":{"outline":"deep"},"headers":[{"level":2,"title":"准备前置条件","slug":"准备前置条件","link":"#准备前置条件","children":[]},{"level":2,"title":"安装租户管理集群","slug":"安装租户管理集群","link":"#安装租户管理集群","children":[]},{"level":2,"title":"注册部署集群","slug":"注册部署集群","link":"#注册部署集群","children":[]},{"level":2,"title":"提交产品配置清单","slug":"提交产品配置清单","link":"#提交产品配置清单","children":[]},{"level":2,"title":"提交部署配置清单","slug":"提交部署配置清单","link":"#提交部署配置清单","children":[]},{"level":2,"title":"跟踪部署过程和结果","slug":"跟踪部署过程和结果","link":"#跟踪部署过程和结果","children":[]}],"relativePath":"guide/user-guide/quickstart-01.md"}'),o={name:"guide/user-guide/quickstart-01.md"},e=[p('<h1 id="从零开始安装部署运行时环境" tabindex="-1">从零开始安装部署运行时环境 <a class="header-anchor" href="#从零开始安装部署运行时环境" aria-hidden="true">#</a></h1><p>本文档将描述从零开始安装集群到自动执行部署的执行过程。包括以下步骤：<br><a href="#%E5%87%86%E5%A4%87%E5%89%8D%E7%BD%AE%E6%9D%A1%E4%BB%B6">准备前置条件</a><br><a href="#%E5%AE%89%E8%A3%85%E7%A7%9F%E6%88%B7%E7%AE%A1%E7%90%86%E9%9B%86%E7%BE%A4">安装租户管理集群</a><br><a href="#%E6%B3%A8%E5%86%8C%E9%83%A8%E7%BD%B2%E9%9B%86%E7%BE%A4">注册部署集群</a><br><a href="#%E6%8F%90%E4%BA%A4%E4%BA%A7%E5%93%81%E9%85%8D%E7%BD%AE%E6%B8%85%E5%8D%95">提交产品配置清单</a><br><a href="#%E6%8F%90%E4%BA%A4%E9%83%A8%E7%BD%B2%E9%85%8D%E7%BD%AE%E6%B8%85%E5%8D%95">提交部署配置清单</a><br><a href="#%E8%B7%9F%E8%B8%AA%E9%83%A8%E7%BD%B2%E8%BF%87%E7%A8%8B%E5%92%8C%E7%BB%93%E6%9E%9C">跟踪部署过程和结果</a></p><h2 id="准备前置条件" tabindex="-1">准备前置条件 <a class="header-anchor" href="#准备前置条件" aria-hidden="true">#</a></h2><p>在开始本节之前，请确保您已阅读 <a href="./user-guide-00.html">用户指南的概述</a> 章节，了解 Nautes 的主流程和相关术语。</p><h2 id="安装租户管理集群" tabindex="-1">安装租户管理集群 <a class="header-anchor" href="#安装租户管理集群" aria-hidden="true">#</a></h2><p>详情参见 <a href="./quickstart-03.html">自动安装 Nautes</a>。</p><h2 id="注册部署集群" tabindex="-1">注册部署集群 <a class="header-anchor" href="#注册部署集群" aria-hidden="true">#</a></h2><p>待补充。</p><h2 id="提交产品配置清单" tabindex="-1">提交产品配置清单 <a class="header-anchor" href="#提交产品配置清单" aria-hidden="true">#</a></h2><p>通过 Nautes CLI 可以自动提交产品、环境、项目、代码库、部署运行时等资源文件，这些资源文件组成了“产品配置清单”。提交成功后，Nautes 将监听产品配置清单向部署集群实施自动部署，以安装产品的部署运行时环境。</p><ol><li>克隆存储产品配置库模板的代码库，批量替换资源的参数值。产品配置库模板的内容如下：</li></ol><div class="language-yaml"><button class="copy"></button><span class="lang">yaml</span><pre><code><span class="line"><span style="color:#676E95;"># 产品</span></span>\n<span class="line"><span style="color:#676E95;"># 批量替换 spec.name、spec.git.gitlab.name、spec.git.gitlab.path、spec.git.gitlab.description等参数值</span></span>\n<span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nautes.resource.nautes.io/v1alpha10329</span></span>\n<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Product</span></span>\n<span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">demo-0329</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">git</span><span style="color:#89DDFF;">:</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">gitlab</span><span style="color:#89DDFF;">:</span></span>\n<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;"># 产品名称</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">demo-0329</span></span>\n<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;"># 产品路径</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">path</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">demo-0329</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">visibility</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">private</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">description</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">demo-0329</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">parentID</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span></span>\n<span class="line"><span style="color:#FFCB6B;">---</span></span>\n<span class="line"><span style="color:#676E95;"># 环境</span></span>\n<span class="line"><span style="color:#676E95;"># 批量替换 spec.name、spec.product等参数值 </span></span>\n<span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nautes.resource.nautes.io/v1alpha1</span></span>\n<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Environment</span></span>\n<span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>\n<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;"># 环镜名称</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">env-demo-0329</span></span>\n<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;"># 环境所属的产品</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">product</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">demo-0329</span></span>\n<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;"># 环境关联的集群</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">cluster</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">test-deployment-runtime</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">envType</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">dev</span></span>\n<span class="line"><span style="color:#FFCB6B;">---</span></span>\n<span class="line"><span style="color:#676E95;"># 项目</span></span>\n<span class="line"><span style="color:#676E95;"># 批量替换 spec.name、spec.product等参数值</span></span>\n<span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">nautes.resource.nautes.io/v1alpha1</span><span style="color:#89DDFF;">&quot;</span></span>\n<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Project</span></span>\n<span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>\n<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;"># 项目名称</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">project-demo-0329</span></span>\n<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;"># 项目所属的产品</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">product</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">demo-0329</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">language</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">golang</span></span>\n<span class="line"><span style="color:#FFCB6B;">---</span></span>\n<span class="line"><span style="color:#676E95;"># 代码库，后续用于存储产品的部署配置清单</span></span>\n<span class="line"><span style="color:#676E95;"># 批量替换 spec.name、spec.product、spec.project、spec.git.gitlab.name、spec.git.gitlab.path、spec.git.gitlab.description</span></span>\n<span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nautes.resource.nautes.io/v1alpha1</span></span>\n<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">CodeRepo</span></span>\n<span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>\n<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;"># 代码库名称</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">coderepo-demo-0329</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">deploymentRuntime</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">pipelineRuntime</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">false</span></span>\n<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;"># 代码库所属的产品</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">product</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">demo-0329</span></span>\n<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;"># 代码库所属的项目</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">project</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">project-demo-0329</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">webhook</span><span style="color:#89DDFF;">:</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">events</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">push_events</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">isolation</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">shared</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">git</span><span style="color:#89DDFF;">:</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">gitlab</span><span style="color:#89DDFF;">:</span></span>\n<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;"># 代码库名称</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">coderepo-demo-0329</span></span>\n<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;"># 代码库路径</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">path</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">coderepo-demo-0329</span><span style="color:#A6ACCD;"> </span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">visibility</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">private</span></span>\n<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">description</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">coderepo-demo-0329</span><span style="color:#A6ACCD;"> </span></span>\n<span class="line"><span style="color:#FFCB6B;">---</span></span>\n<span class="line"><span style="color:#676E95;"># 部署运行时</span></span>\n<span class="line"><span style="color:#676E95;"># 批量替换 spec.name、spec.destination、spec.manifestsource.codeRepo、spec.product、spec.projectsRef</span></span>\n<span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nautes.resource.nautes.io/v1alpha1</span></span>\n<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">DeploymentRuntime</span></span>\n<span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>\n<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;"># 部署运行时名称</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">dr-demo-0329</span></span>\n<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;"># 部署运行时的目标集群，这里指部署集群</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">destination</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">env-demo-0329</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">manifestsource</span><span style="color:#89DDFF;">:</span></span>\n<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;"># 部署运行时监听的代码库</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">codeRepo</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">coderepo-demo-0329</span></span>\n<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;"># 部署运行时监听的代码库相对路径</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">path</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">deployments</span></span>\n<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;"># 部署运行时监听的代码库版本或代码库分支</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">targetRevision</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">main</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">product</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">demo-0329</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">projectsRef</span><span style="color:#89DDFF;">:</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">project-demo-0329</span></span>\n<span class="line"></span></code></pre></div><ol start="2"><li>将 nautes.exe【补充下载链接】 文件保存在 Windows 操作系统的某个目录下，然后执行以下命令。执行成功后，Nautes 将生成产品配置清单，并自动安装产品的部署运行时环境。其中，“examples/demo.yaml”是存储产品配置库模板的代码库的相对路径，gitlab-access-token 是您的 GitLab 访问令牌，api-server-address 是 Nautes API 的访问地址。</li></ol><div class="language-cmd"><button class="copy"></button><span class="lang">cmd</span><pre><code><span class="line"><span style="color:#A6ACCD;">nautes apply </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">f examples/demo.yaml </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">t </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">gitlab</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">access</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">token </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">s </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">api</span><span style="color:#89DDFF;">-</span><span style="color:#FFCB6B;">server</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">address</span></span>\n<span class="line"></span></code></pre></div><h2 id="提交部署配置清单" tabindex="-1">提交部署配置清单 <a class="header-anchor" href="#提交部署配置清单" aria-hidden="true">#</a></h2><p>通过 Git CLI 提交产品的部署配置清单，例如 deployment、service、volume 等资源。提交成功后，Nautes 将部署配置清单自动同步到产品的部署运行时环境，并执行自动部署。详情参考 <a href="https://docs.gitlab.com/ee/tutorials/make_your_first_git_commit.html" target="_blank" rel="noreferrer">GitLab</a>。</p><h2 id="跟踪部署过程和结果" tabindex="-1">跟踪部署过程和结果 <a class="header-anchor" href="#跟踪部署过程和结果" aria-hidden="true">#</a></h2><p>在部署产品的过程中或部署完成后，可以通过 ArgoCD 控制台或者 kubectl 命令行来跟踪部署过程和结果。这两种方式均支持单点登录，方便用户管理被授权的产品资源。详情参考 <a href="./user-guide-06.html">跟踪部署过程和结果</a>。</p>',18)];const c=s(o,[["render",function(s,p,l,o,c,t){return n(),a("div",null,e)}]]);export{l as __pageData,c as default};
